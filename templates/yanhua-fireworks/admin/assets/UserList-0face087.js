import{g as P,a as A,u as F}from"./user-7097b33c.js";import{b as j,r as b,c as V,x as q,e as n,y as G,o as k,f as H,h as e,w as a,i as s,z as J,p as U,t as i,g as K,l as O,E as m,A as Q}from"./index-1dad1f50.js";import{_ as W}from"./_plugin-vue_export-helper-c27b6911.js";import"./request-0b13b1fd.js";const X={class:"page-container"},Y={class:"pagination-wrap"},Z=j({__name:"UserList",setup(ee){const w=b(!1),h=b([]),g=V({keyword:"",dateRange:[]}),d=V({page:1,pageSize:10,total:0}),y=b(!1),r=b(null),f=async()=>{w.value=!0;try{const l=await P({page:d.page,pageSize:d.pageSize,keyword:g.keyword||void 0});l.data.code===200?(h.value=l.data.data.records,d.total=l.data.data.total):m.error(l.data.message||"获取用户列表失败")}catch(l){console.error("获取用户列表失败:",l),m.error(l.message||"获取用户列表失败")}finally{w.value=!1}},D=()=>{d.page=1,f()},S=()=>{g.keyword="",g.dateRange=[],d.page=1,f()},$=l=>{d.page=l,f()},z=async l=>{try{const t=await A(l.id);t.data.code===200?(r.value=t.data.data,y.value=!0):m.error(t.data.message||"获取用户详情失败")}catch(t){console.error("获取用户详情失败:",t),m.error(t.message||"获取用户详情失败")}},B=async l=>{const t=l.status===1?0:1,_=t===1?"启用":"禁用";try{await Q.confirm(`确定要${_}用户"${l.nickname}"吗？`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"});const c=await F({id:l.id,status:t});c.data.code===200?(m.success(`${_}成功`),f()):m.error(c.data.message||`${_}失败`)}catch(c){c!=="cancel"&&(console.error(`${_}用户失败:`,c),m.error(c.message||`${_}失败`))}};return q(()=>{f()}),(l,t)=>{const _=n("el-input"),c=n("el-form-item"),v=n("el-button"),T=n("el-form"),x=n("el-card"),p=n("el-table-column"),C=n("el-tag"),L=n("el-table"),E=n("el-pagination"),u=n("el-descriptions-item"),N=n("el-descriptions"),I=n("el-dialog"),M=G("loading");return k(),H("div",X,[e(x,{shadow:"never",class:"search-card"},{default:a(()=>[e(T,{model:g,inline:""},{default:a(()=>[e(c,{label:"关键词"},{default:a(()=>[e(_,{modelValue:g.keyword,"onUpdate:modelValue":t[0]||(t[0]=o=>g.keyword=o),placeholder:"昵称/手机号",clearable:"",style:{width:"200px"}},null,8,["modelValue"])]),_:1}),e(c,null,{default:a(()=>[e(v,{type:"primary",onClick:D},{default:a(()=>[...t[4]||(t[4]=[s("搜索",-1)])]),_:1}),e(v,{onClick:S},{default:a(()=>[...t[5]||(t[5]=[s("重置",-1)])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),e(x,{shadow:"never",class:"table-card"},{default:a(()=>[J((k(),U(L,{data:h.value,stripe:""},{default:a(()=>[e(p,{prop:"id",label:"ID",width:"80"}),e(p,{prop:"nickname",label:"昵称","min-width":"120"}),e(p,{prop:"phone",label:"手机号",width:"130"}),e(p,{prop:"region",label:"地区",width:"120"}),e(p,{prop:"points",label:"积分",width:"100"}),e(p,{prop:"status",label:"状态",width:"100"},{default:a(({row:o})=>[e(C,{type:o.status===1?"success":"danger"},{default:a(()=>[s(i(o.status===1?"正常":"禁用"),1)]),_:2},1032,["type"])]),_:1}),e(p,{prop:"createTime",label:"注册时间",width:"180"}),e(p,{label:"操作",width:"200",fixed:"right"},{default:a(({row:o})=>[e(v,{type:"primary",link:"",onClick:R=>z(o)},{default:a(()=>[...t[6]||(t[6]=[s("查看详情",-1)])]),_:1},8,["onClick"]),e(v,{type:o.status===1?"danger":"success",link:"",onClick:R=>B(o)},{default:a(()=>[s(i(o.status===1?"禁用":"启用"),1)]),_:2},1032,["type","onClick"])]),_:1})]),_:1},8,["data"])),[[M,w.value]]),K("div",Y,[e(E,{"current-page":d.page,"onUpdate:currentPage":t[1]||(t[1]=o=>d.page=o),"page-size":d.pageSize,total:d.total,layout:"total, prev, pager, next",onCurrentChange:$},null,8,["current-page","page-size","total"])])]),_:1}),e(I,{modelValue:y.value,"onUpdate:modelValue":t[3]||(t[3]=o=>y.value=o),title:"用户详情",width:"600px"},{footer:a(()=>[e(v,{onClick:t[2]||(t[2]=o=>y.value=!1)},{default:a(()=>[...t[7]||(t[7]=[s("关闭",-1)])]),_:1})]),default:a(()=>[r.value?(k(),U(N,{key:0,column:2,border:""},{default:a(()=>[e(u,{label:"用户ID"},{default:a(()=>[s(i(r.value.id),1)]),_:1}),e(u,{label:"昵称"},{default:a(()=>[s(i(r.value.nickname),1)]),_:1}),e(u,{label:"手机号"},{default:a(()=>[s(i(r.value.phone),1)]),_:1}),e(u,{label:"地区"},{default:a(()=>[s(i(r.value.region||"未设置"),1)]),_:1}),e(u,{label:"积分"},{default:a(()=>[s(i(r.value.points),1)]),_:1}),e(u,{label:"状态"},{default:a(()=>[e(C,{type:r.value.status===1?"success":"danger"},{default:a(()=>[s(i(r.value.status===1?"正常":"禁用"),1)]),_:1},8,["type"])]),_:1}),e(u,{label:"注册时间",span:2},{default:a(()=>[s(i(r.value.createTime),1)]),_:1}),e(u,{label:"更新时间",span:2},{default:a(()=>[s(i(r.value.updateTime),1)]),_:1})]),_:1})):O("",!0)]),_:1},8,["modelValue"])])}}});const se=W(Z,[["__scopeId","data-v-c64e12d7"]]);export{se as default};
