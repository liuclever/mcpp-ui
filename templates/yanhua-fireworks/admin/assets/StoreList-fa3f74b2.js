import{g as F,d as R,u as j,a as G}from"./store-76bfd8b7.js";import{b as J,r as c,c as U,x as K,e as s,y as O,o as z,f as Q,h as l,w as a,i as u,g as b,z as W,p as X,t as Y,E as d,A as Z}from"./index-1dad1f50.js";import{_ as ee}from"./_plugin-vue_export-helper-c27b6911.js";import"./request-0b13b1fd.js";const le={class:"page-container"},ae={class:"card-header"},te={class:"pagination-wrap"},oe={style:{display:"flex",gap:"10px"}},ne=J({__name:"StoreList",setup(se){const y=c(!1),w=c([]),v=U({keyword:""}),r=U({page:1,pageSize:10,total:0}),f=c(!1),V=c("新增门店"),o=c({name:"",address:"",phone:"",latitude:0,longitude:0,businessHours:"09:00-18:00",status:1}),g=async()=>{y.value=!0;try{const n=await F({page:r.page,pageSize:r.pageSize,keyword:v.keyword||void 0});n.data.code===200?(w.value=n.data.data.records,r.total=n.data.data.total):d.error(n.data.message||"获取门店列表失败")}catch(n){console.error("获取门店列表失败:",n),d.error(n.message||"获取门店列表失败")}finally{y.value=!1}},h=()=>{r.page=1,g()},B=()=>{v.keyword="",r.page=1,g()},D=n=>{r.page=n,g()},E=()=>{V.value="新增门店",o.value={name:"",address:"",phone:"",latitude:0,longitude:0,businessHours:"09:00-18:00",status:1},f.value=!0},H=n=>{V.value="编辑门店",o.value={...n},f.value=!0},L=async n=>{try{await Z.confirm(`确定要删除门店"${n.name}"吗？`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"});const e=await R(n.id);e.data.code===200?(d.success("删除成功"),g()):d.error(e.data.message||"删除失败")}catch(e){e!=="cancel"&&(console.error("删除门店失败:",e),d.error(e.message||"删除失败"))}},T=async()=>{if(!o.value.name){d.warning("请输入门店名称");return}if(!o.value.address){d.warning("请输入门店地址");return}if(!o.value.phone){d.warning("请输入联系电话");return}try{let n;o.value.id?n=await j(o.value):n=await G(o.value),n.data.code===200?(d.success(o.value.id?"更新成功":"添加成功"),f.value=!1,g()):d.error(n.data.message||"操作失败")}catch(n){console.error("保存门店失败:",n),d.error(n.message||"操作失败")}};return K(()=>{g()}),(n,e)=>{const _=s("el-input"),i=s("el-form-item"),p=s("el-button"),x=s("el-form"),k=s("el-card"),m=s("el-table-column"),$=s("el-tag"),q=s("el-table"),M=s("el-pagination"),C=s("el-input-number"),S=s("el-radio"),N=s("el-radio-group"),A=s("el-dialog"),I=O("loading");return z(),Q("div",le,[l(k,{shadow:"never",class:"search-card"},{default:a(()=>[l(x,{model:v,inline:""},{default:a(()=>[l(i,{label:"关键词"},{default:a(()=>[l(_,{modelValue:v.keyword,"onUpdate:modelValue":e[0]||(e[0]=t=>v.keyword=t),placeholder:"门店名称/地址/电话",clearable:"",style:{width:"250px"}},null,8,["modelValue"])]),_:1}),l(i,null,{default:a(()=>[l(p,{type:"primary",onClick:h},{default:a(()=>[...e[11]||(e[11]=[u("搜索",-1)])]),_:1}),l(p,{onClick:B},{default:a(()=>[...e[12]||(e[12]=[u("重置",-1)])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),l(k,{shadow:"never",class:"table-card"},{header:a(()=>[b("div",ae,[e[14]||(e[14]=b("span",null,"门店列表",-1)),l(p,{type:"primary",onClick:E},{default:a(()=>[...e[13]||(e[13]=[u("新增门店",-1)])]),_:1})])]),default:a(()=>[W((z(),X(q,{data:w.value,stripe:""},{default:a(()=>[l(m,{prop:"id",label:"ID",width:"80"}),l(m,{prop:"name",label:"门店名称","min-width":"150"}),l(m,{prop:"address",label:"地址","min-width":"200"}),l(m,{prop:"phone",label:"联系电话",width:"130"}),l(m,{prop:"businessHours",label:"营业时间",width:"120"}),l(m,{prop:"status",label:"状态",width:"100"},{default:a(({row:t})=>[l($,{type:t.status===1?"success":"danger"},{default:a(()=>[u(Y(t.status===1?"营业中":"已关闭"),1)]),_:2},1032,["type"])]),_:1}),l(m,{label:"操作",width:"150",fixed:"right"},{default:a(({row:t})=>[l(p,{type:"primary",link:"",onClick:P=>H(t)},{default:a(()=>[...e[15]||(e[15]=[u("编辑",-1)])]),_:1},8,["onClick"]),l(p,{type:"danger",link:"",onClick:P=>L(t)},{default:a(()=>[...e[16]||(e[16]=[u("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[I,y.value]]),b("div",te,[l(M,{"current-page":r.page,"onUpdate:currentPage":e[1]||(e[1]=t=>r.page=t),"page-size":r.pageSize,total:r.total,layout:"total, prev, pager, next",onCurrentChange:D},null,8,["current-page","page-size","total"])])]),_:1}),l(A,{modelValue:f.value,"onUpdate:modelValue":e[10]||(e[10]=t=>f.value=t),title:V.value,width:"600px"},{footer:a(()=>[l(p,{onClick:e[9]||(e[9]=t=>f.value=!1)},{default:a(()=>[...e[20]||(e[20]=[u("取消",-1)])]),_:1}),l(p,{type:"primary",onClick:T},{default:a(()=>[...e[21]||(e[21]=[u("保存",-1)])]),_:1})]),default:a(()=>[l(x,{model:o.value,"label-width":"100px"},{default:a(()=>[l(i,{label:"门店名称",required:""},{default:a(()=>[l(_,{modelValue:o.value.name,"onUpdate:modelValue":e[2]||(e[2]=t=>o.value.name=t),placeholder:"请输入门店名称"},null,8,["modelValue"])]),_:1}),l(i,{label:"门店地址",required:""},{default:a(()=>[l(_,{modelValue:o.value.address,"onUpdate:modelValue":e[3]||(e[3]=t=>o.value.address=t),placeholder:"请输入门店地址"},null,8,["modelValue"])]),_:1}),l(i,{label:"联系电话",required:""},{default:a(()=>[l(_,{modelValue:o.value.phone,"onUpdate:modelValue":e[4]||(e[4]=t=>o.value.phone=t),placeholder:"请输入联系电话"},null,8,["modelValue"])]),_:1}),l(i,{label:"营业时间"},{default:a(()=>[l(_,{modelValue:o.value.businessHours,"onUpdate:modelValue":e[5]||(e[5]=t=>o.value.businessHours=t),placeholder:"例如：09:00-18:00"},null,8,["modelValue"])]),_:1}),l(i,{label:"经纬度"},{default:a(()=>[b("div",oe,[l(C,{modelValue:o.value.latitude,"onUpdate:modelValue":e[6]||(e[6]=t=>o.value.latitude=t),precision:6,placeholder:"纬度",style:{flex:"1"}},null,8,["modelValue"]),l(C,{modelValue:o.value.longitude,"onUpdate:modelValue":e[7]||(e[7]=t=>o.value.longitude=t),precision:6,placeholder:"经度",style:{flex:"1"}},null,8,["modelValue"])]),e[17]||(e[17]=b("div",{style:{color:"#999","font-size":"12px","margin-top":"5px"}}," 提示：可以在地图上获取门店的经纬度坐标 ",-1))]),_:1}),l(i,{label:"状态"},{default:a(()=>[l(N,{modelValue:o.value.status,"onUpdate:modelValue":e[8]||(e[8]=t=>o.value.status=t)},{default:a(()=>[l(S,{label:1},{default:a(()=>[...e[18]||(e[18]=[u("营业中",-1)])]),_:1}),l(S,{label:0},{default:a(()=>[...e[19]||(e[19]=[u("已关闭",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}});const pe=ee(ne,[["__scopeId","data-v-fbfdc330"]]);export{pe as default};
