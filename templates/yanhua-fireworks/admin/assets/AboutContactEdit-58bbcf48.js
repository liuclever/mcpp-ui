import{s as _}from"./request-0b13b1fd.js";import{b as D,r as i,x as A,e as u,y as R,o as V,f as $,h as o,w as d,g as s,z as k,p as E,i as x,E as m}from"./index-1dad1f50.js";import{_ as L}from"./_plugin-vue_export-helper-c27b6911.js";function q(){return _({url:"/about/contact",method:"get"})}function z(v){return _({url:"/admin/about/contact",method:"put",data:v})}const B={class:"about-contact-edit"},M=D({__name:"AboutContactEdit",setup(v){const p=i(),g=i(!1),f=i(!1),a=i({id:1,logoUrl:"",companyName:"",address:"",phone1:"",phone2:"",phone3:"",fax:"",email:"",latitude:void 0,longitude:void 0}),h={logoUrl:[{required:!0,message:"请输入Logo图片URL",trigger:"blur"}],companyName:[{required:!0,message:"请输入公司名称",trigger:"blur"},{min:2,max:100,message:"长度在 2 到 100 个字符",trigger:"blur"}],address:[{required:!0,message:"请输入公司地址",trigger:"blur"},{min:5,max:500,message:"长度在 5 到 500 个字符",trigger:"blur"}],phone1:[{required:!0,message:"请输入主要联系电话",trigger:"blur"},{pattern:/^1[3-9]\d{9}$|^0\d{2,3}-?\d{7,8}$/,message:"请输入正确的电话号码格式",trigger:"blur"}],phone2:[{pattern:/^1[3-9]\d{9}$|^0\d{2,3}-?\d{7,8}$/,message:"请输入正确的电话号码格式",trigger:"blur"}],phone3:[{pattern:/^1[3-9]\d{9}$|^0\d{2,3}-?\d{7,8}$/,message:"请输入正确的电话号码格式",trigger:"blur"}],email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{pattern:/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/,message:"请输入正确的邮箱格式",trigger:"blur"}],latitude:[{type:"number",min:-90,max:90,message:"纬度范围为 -90 到 90",trigger:"blur"}],longitude:[{type:"number",min:-180,max:180,message:"经度范围为 -180 到 180",trigger:"blur"}]},c=async()=>{var n,e;g.value=!0;try{const l=await q();if(console.log("=== API Response Debug ==="),console.log("Full response:",l),console.log("res.data:",l.data),console.log("res.data.code:",(n=l.data)==null?void 0:n.code),console.log("res.data.data:",(e=l.data)==null?void 0:e.data),l.data&&l.data.code===200&&l.data.data){console.log("Setting formData with:",l.data.data);const t=l.data.data;a.value={id:t.id||1,logoUrl:t.logoUrl||"",companyName:t.companyName||"",address:t.address||"",phone1:t.phone1||"",phone2:t.phone2||"",phone3:t.phone3||"",fax:t.fax||"",email:t.email||"",latitude:t.latitude,longitude:t.longitude},console.log("formData after set:",a.value)}else console.error("Invalid response structure:",l),m.error("数据格式错误")}catch(l){console.error("加载联系信息失败:",l),m.error("加载联系信息失败")}finally{g.value=!1}},y=async()=>{var n,e;if(p.value)try{await p.value.validate(),f.value=!0;const l=await z(a.value);console.log("=== Update Response Debug ==="),console.log("Full response:",l),console.log("res.data:",l.data),console.log("res.data.code:",(n=l.data)==null?void 0:n.code),l.data&&l.data.code===200?(m.success("保存成功"),await c()):m.error(((e=l.data)==null?void 0:e.message)||"保存失败")}catch(l){l!==!1&&(console.error("保存失败:",l),m.error("保存失败"))}finally{f.value=!1}},U=()=>{c()};return A(()=>{c()}),(n,e)=>{const l=u("el-input"),t=u("el-form-item"),b=u("el-button"),w=u("el-form"),C=u("el-card"),N=R("loading");return V(),$("div",B,[o(C,null,{header:d(()=>[...e[10]||(e[10]=[s("div",{class:"card-header"},[s("span",null,"联系信息管理")],-1)])]),default:d(()=>[k((V(),E(w,{ref_key:"formRef",ref:p,model:a.value,rules:h,"label-width":"120px"},{default:d(()=>[o(t,{label:"公司名称",prop:"companyName"},{default:d(()=>[o(l,{modelValue:a.value.companyName,"onUpdate:modelValue":e[0]||(e[0]=r=>a.value.companyName=r),placeholder:"请输入公司名称",maxlength:"100","show-word-limit":""},null,8,["modelValue"])]),_:1}),o(t,{label:"公司地址",prop:"address"},{default:d(()=>[o(l,{modelValue:a.value.address,"onUpdate:modelValue":e[1]||(e[1]=r=>a.value.address=r),type:"textarea",rows:3,placeholder:"请输入公司地址",maxlength:"200","show-word-limit":""},null,8,["modelValue"])]),_:1}),o(t,{label:"公司Logo",prop:"logoUrl"},{default:d(()=>[o(l,{modelValue:a.value.logoUrl,"onUpdate:modelValue":e[2]||(e[2]=r=>a.value.logoUrl=r),placeholder:"请输入Logo图片URL",maxlength:"500"},null,8,["modelValue"]),e[11]||(e[11]=s("div",{class:"form-tip"},"请先上传图片到服务器，然后填入图片URL",-1))]),_:1}),o(t,{label:"主要电话",prop:"phone1"},{default:d(()=>[o(l,{modelValue:a.value.phone1,"onUpdate:modelValue":e[3]||(e[3]=r=>a.value.phone1=r),placeholder:"请输入主要联系电话",maxlength:"20"},null,8,["modelValue"])]),_:1}),o(t,{label:"备用电话1",prop:"phone2"},{default:d(()=>[o(l,{modelValue:a.value.phone2,"onUpdate:modelValue":e[4]||(e[4]=r=>a.value.phone2=r),placeholder:"请输入备用电话（选填）",maxlength:"20"},null,8,["modelValue"])]),_:1}),o(t,{label:"备用电话2",prop:"phone3"},{default:d(()=>[o(l,{modelValue:a.value.phone3,"onUpdate:modelValue":e[5]||(e[5]=r=>a.value.phone3=r),placeholder:"请输入备用电话（选填）",maxlength:"20"},null,8,["modelValue"])]),_:1}),o(t,{label:"传真",prop:"fax"},{default:d(()=>[o(l,{modelValue:a.value.fax,"onUpdate:modelValue":e[6]||(e[6]=r=>a.value.fax=r),placeholder:"请输入传真号码（选填）",maxlength:"20"},null,8,["modelValue"])]),_:1}),o(t,{label:"邮箱",prop:"email"},{default:d(()=>[o(l,{modelValue:a.value.email,"onUpdate:modelValue":e[7]||(e[7]=r=>a.value.email=r),placeholder:"请输入邮箱",maxlength:"100"},null,8,["modelValue"])]),_:1}),o(t,{label:"经度",prop:"longitude"},{default:d(()=>[o(l,{modelValue:a.value.longitude,"onUpdate:modelValue":e[8]||(e[8]=r=>a.value.longitude=r),modelModifiers:{number:!0},placeholder:"请输入经度（用于地图导航）",type:"number",step:"0.000001"},null,8,["modelValue"]),e[12]||(e[12]=s("div",{class:"form-tip"},"用于小程序一键导航功能",-1))]),_:1}),o(t,{label:"纬度",prop:"latitude"},{default:d(()=>[o(l,{modelValue:a.value.latitude,"onUpdate:modelValue":e[9]||(e[9]=r=>a.value.latitude=r),modelModifiers:{number:!0},placeholder:"请输入纬度（用于地图导航）",type:"number",step:"0.000001"},null,8,["modelValue"]),e[13]||(e[13]=s("div",{class:"form-tip"},"用于小程序一键导航功能",-1))]),_:1}),o(t,null,{default:d(()=>[o(b,{type:"primary",onClick:y,loading:f.value},{default:d(()=>[...e[14]||(e[14]=[x(" 保存 ",-1)])]),_:1},8,["loading"]),o(b,{onClick:U},{default:d(()=>[...e[15]||(e[15]=[x("取消",-1)])]),_:1})]),_:1})]),_:1},8,["model"])),[[N,g.value]])]),_:1})])}}});const S=L(M,[["__scopeId","data-v-1a7831c5"]]);export{S as default};
