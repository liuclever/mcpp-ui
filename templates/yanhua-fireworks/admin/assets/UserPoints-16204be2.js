import{g as E,b as N}from"./user-7097b33c.js";import{b as $,r as d,c as C,x as A,e as s,y as R,o as c,f as x,h as a,w as o,F as j,m as q,i as g,g as m,z as G,p as I,t as f,n as H,E as z}from"./index-1dad1f50.js";import{_ as J}from"./_plugin-vue_export-helper-c27b6911.js";import"./request-0b13b1fd.js";const K={class:"page-container"},O={class:"pagination-wrap"},Q=$({__name:"UserPoints",setup(W){const u=d(!1),v=d([]),i=C({userId:void 0}),n=C({page:1,pageSize:10,total:0}),b=d([]),_=d(!1),U=async()=>{_.value=!0;try{const e=await E({page:1,pageSize:100});e.data.code===200&&(b.value=e.data.data.records)}catch(e){console.error("获取用户列表失败:",e)}finally{_.value=!1}},p=async()=>{u.value=!0;try{const e=await N({page:n.page,pageSize:n.pageSize,userId:i.userId});e.data.code===200?(v.value=e.data.data.records,n.total=e.data.data.total):z.error(e.data.message||"获取积分记录失败")}catch(e){console.error("获取积分记录失败:",e),z.error(e.message||"获取积分记录失败")}finally{u.value=!1}},k=()=>{n.page=1,p()},P=()=>{i.userId=void 0,n.page=1,p()},S=e=>{n.page=e,p()},D=e=>({register:"注册奖励",login:"每日登录",publish:"发布内容",comment:"发表评论",like:"点赞",share:"分享",admin:"管理员操作"})[e]||e;return A(()=>{U(),p()}),(e,l)=>{const V=s("el-option"),L=s("el-select"),y=s("el-form-item"),h=s("el-button"),B=s("el-form"),w=s("el-card"),r=s("el-table-column"),F=s("el-table"),M=s("el-pagination"),T=R("loading");return c(),x("div",K,[a(w,{shadow:"never",class:"search-card"},{default:o(()=>[a(B,{model:i,inline:""},{default:o(()=>[a(y,{label:"用户筛选"},{default:o(()=>[a(L,{modelValue:i.userId,"onUpdate:modelValue":l[0]||(l[0]=t=>i.userId=t),placeholder:"请选择用户",clearable:"",filterable:"",style:{width:"200px"},loading:_.value},{default:o(()=>[(c(!0),x(j,null,q(b.value,t=>(c(),I(V,{key:t.id,label:`${t.nickname} (${t.phone})`,value:t.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","loading"])]),_:1}),a(y,null,{default:o(()=>[a(h,{type:"primary",onClick:k},{default:o(()=>[...l[2]||(l[2]=[g("搜索",-1)])]),_:1}),a(h,{onClick:P},{default:o(()=>[...l[3]||(l[3]=[g("重置",-1)])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),a(w,{shadow:"never",class:"table-card"},{header:o(()=>[...l[4]||(l[4]=[m("span",null,"积分变动记录",-1)])]),default:o(()=>[G((c(),I(F,{data:v.value,stripe:""},{default:o(()=>[a(r,{prop:"id",label:"ID",width:"80"}),a(r,{prop:"userId",label:"用户ID",width:"100"}),a(r,{prop:"points",label:"积分变动",width:"120"},{default:o(({row:t})=>[m("span",{style:H({color:t.points>0?"#67C23A":"#F56C6C"})},f(t.points>0?"+":"")+f(t.points),5)]),_:1}),a(r,{prop:"type",label:"类型",width:"120"},{default:o(({row:t})=>[g(f(D(t.type)),1)]),_:1}),a(r,{prop:"reason",label:"原因","min-width":"200"}),a(r,{prop:"createTime",label:"时间",width:"180"})]),_:1},8,["data"])),[[T,u.value]]),m("div",O,[a(M,{"current-page":n.page,"onUpdate:currentPage":l[1]||(l[1]=t=>n.page=t),"page-size":n.pageSize,total:n.total,layout:"total, prev, pager, next",onCurrentChange:S},null,8,["current-page","page-size","total"])])]),_:1})])}}});const ae=J(Q,[["__scopeId","data-v-a1725e41"]]);export{ae as default};
