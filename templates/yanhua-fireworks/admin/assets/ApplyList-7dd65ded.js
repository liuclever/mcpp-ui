import{b as N,r as k}from"./store-76bfd8b7.js";import{b as P,r as w,c as x,x as I,e as n,y as R,o as g,f as y,h as t,w as o,i as u,g as C,z as U,p as j,t as q,F as G,E as i,A as B}from"./index-1dad1f50.js";import{_ as H}from"./_plugin-vue_export-helper-c27b6911.js";import"./request-0b13b1fd.js";const J={class:"page-container"},K={key:1,class:"text-gray"},O={class:"pagination-wrap"},Q=P({__name:"ApplyList",setup(W){const f=w(!1),v=w([]),d=x({status:void 0}),l=x({page:1,pageSize:10,total:0}),p=async()=>{f.value=!0;try{const a=await N({page:l.page,pageSize:l.pageSize,status:d.status});a.data.code===200?(v.value=a.data.data.records,l.total=a.data.data.total):i.error(a.data.message||"获取申请列表失败")}catch(a){console.error("获取申请列表失败:",a),i.error(a.message||"获取申请列表失败")}finally{f.value=!1}},A=()=>{l.page=1,p()},z=()=>{d.status=void 0,l.page=1,p()},V=a=>{l.page=a,p()},S=async a=>{try{await B.confirm(`确定通过"${a.name}"的入驻申请吗？`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"});const e=await k({id:a.id,status:1,remark:"审核通过"});e.data.code===200?(i.success("已通过"),p()):i.error(e.data.message||"操作失败")}catch(e){e!=="cancel"&&(console.error("审核失败:",e),i.error(e.message||"操作失败"))}},T=async a=>{try{const{value:e}=await B.prompt(`确定拒绝"${a.name}"的入驻申请吗？请输入拒绝原因：`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",inputPlaceholder:"请输入拒绝原因",inputValidator:_=>!_||_.trim()===""?"请输入拒绝原因":!0}),c=await k({id:a.id,status:2,remark:e||"审核不通过"});c.data.code===200?(i.success("已拒绝"),p()):i.error(c.data.message||"操作失败")}catch(e){e!=="cancel"&&(console.error("审核失败:",e),i.error(e.message||"操作失败"))}};return I(()=>{p()}),(a,e)=>{const c=n("el-option"),_=n("el-select"),b=n("el-form-item"),m=n("el-button"),D=n("el-form"),h=n("el-card"),r=n("el-table-column"),L=n("el-tag"),E=n("el-table"),$=n("el-pagination"),F=R("loading");return g(),y("div",J,[t(h,{shadow:"never",class:"search-card"},{default:o(()=>[t(D,{model:d,inline:""},{default:o(()=>[t(b,{label:"状态"},{default:o(()=>[t(_,{modelValue:d.status,"onUpdate:modelValue":e[0]||(e[0]=s=>d.status=s),placeholder:"全部",clearable:"",style:{width:"150px"}},{default:o(()=>[t(c,{label:"待审核",value:0}),t(c,{label:"已通过",value:1}),t(c,{label:"已拒绝",value:2})]),_:1},8,["modelValue"])]),_:1}),t(b,null,{default:o(()=>[t(m,{type:"primary",onClick:A},{default:o(()=>[...e[2]||(e[2]=[u("搜索",-1)])]),_:1}),t(m,{onClick:z},{default:o(()=>[...e[3]||(e[3]=[u("重置",-1)])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),t(h,{shadow:"never",class:"table-card"},{header:o(()=>[...e[4]||(e[4]=[C("span",null,"入驻申请列表",-1)])]),default:o(()=>[U((g(),j(E,{data:v.value,stripe:""},{default:o(()=>[t(r,{prop:"id",label:"ID",width:"80"}),t(r,{prop:"name",label:"联系人",width:"120"}),t(r,{prop:"company",label:"公司名称","min-width":"200"}),t(r,{prop:"phone",label:"联系电话",width:"130"}),t(r,{prop:"createTime",label:"申请时间",width:"180"}),t(r,{prop:"status",label:"状态",width:"100"},{default:o(({row:s})=>[t(L,{type:s.status===0?"warning":s.status===1?"success":"danger"},{default:o(()=>[u(q(s.status===0?"待审核":s.status===1?"已通过":"已拒绝"),1)]),_:2},1032,["type"])]),_:1}),t(r,{prop:"remark",label:"备注","min-width":"150"}),t(r,{label:"操作",width:"150",fixed:"right"},{default:o(({row:s})=>[s.status===0?(g(),y(G,{key:0},[t(m,{type:"success",link:"",onClick:M=>S(s)},{default:o(()=>[...e[5]||(e[5]=[u("通过",-1)])]),_:1},8,["onClick"]),t(m,{type:"danger",link:"",onClick:M=>T(s)},{default:o(()=>[...e[6]||(e[6]=[u("拒绝",-1)])]),_:1},8,["onClick"])],64)):(g(),y("span",K,"已处理"))]),_:1})]),_:1},8,["data"])),[[F,f.value]]),C("div",O,[t($,{"current-page":l.page,"onUpdate:currentPage":e[1]||(e[1]=s=>l.page=s),"page-size":l.pageSize,total:l.total,layout:"total, prev, pager, next",onCurrentChange:V},null,8,["current-page","page-size","total"])])]),_:1})])}}});const te=H(Q,[["__scopeId","data-v-4eef3b28"]]);export{te as default};
