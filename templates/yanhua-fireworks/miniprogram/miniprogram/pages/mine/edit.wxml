<!--pages/mine/edit.wxml-->
<view class="edit-container">
  <!-- 用户信息编辑区 -->
  <view class="edit-section">
    <!-- 头像编辑 - 使用微信chooseAvatar获取头像 -->
    <view class="edit-item">
      <view class="item-label">头像</view>
      <button class="avatar-button" open-type="chooseAvatar" bindchooseavatar="onChooseAvatar">
        <image class="avatar" src="{{userInfo.avatar || 'https://zhengpan-fireworks-1392575669.cos.ap-shanghai.myqcloud.com/miniprogram/assets/images/default-avatar.png'}}" mode="aspectFill"></image>
        <text class="item-arrow">></text>
      </button>
    </view>

    <!-- 昵称编辑 - 使用微信nickname类型输入框获取昵称 -->
    <view class="edit-item">
      <view class="item-label">昵称</view>
      <view class="item-content">
        <input 
          class="item-input" 
          type="nickname"
          value="{{userInfo.nickname}}" 
          placeholder="点击获取微信昵称"
          maxlength="20"
          bindinput="onNicknameInput"
          bindblur="onNicknameBlur"
        />
      </view>
    </view>

    <!-- 手机号（不可编辑） -->
    <view class="edit-item">
      <view class="item-label">手机号</view>
      <view class="item-content">
        <text class="item-text disabled">{{userInfo.phone}}</text>
      </view>
    </view>

    <!-- 地区选择 -->
    <view class="edit-item">
      <view class="item-label">所在地区</view>
      <picker mode="region" bindchange="onRegionChange" value="{{regionValue}}">
        <view class="item-content">
          <text class="item-text {{userInfo.region ? '' : 'placeholder'}}">{{userInfo.region || '请选择所在地区'}}</text>
          <text class="item-arrow">></text>
        </view>
      </picker>
    </view>

    <!-- 积分（不可编辑） -->
    <view class="edit-item">
      <view class="item-label">积分</view>
      <view class="item-content">
        <text class="item-text disabled">{{userInfo.points}}</text>
      </view>
    </view>
  </view>

  <!-- 功能菜单 -->
  <view class="function-menu">
    <view class="menu-item" bindtap="goToCollect">
      <text class="menu-label">我的收藏</text>
      <text class="menu-arrow">></text>
    </view>
    <view class="menu-item" bindtap="goToPublish">
      <text class="menu-label">我的发布</text>
      <text class="menu-arrow">></text>
    </view>
    <view class="menu-item" bindtap="goToLike">
      <text class="menu-label">我的点赞</text>
      <text class="menu-arrow">></text>
    </view>
  </view>

  <!-- 保存按钮 -->
  <view class="save-button-container">
    <button class="save-button" bindtap="saveUserInfo">保存</button>
  </view>
</view>
